# üîó API Endpoints Reference Guide

## üìç **1. Base URL**

```
http://localhost:8080
```

**Note:** The port is commented out in `application.properties`, so Spring Boot uses the default port **8080**. If you want to change it, uncomment and modify the `server.port` setting.

---

## üîê **2. Authentication Endpoints**

### **Signup (Register) Endpoint**

**Path:** `POST /auth/register`

**Full URL:** `http://localhost:8080/auth/register`

**Request Headers:**
```
Content-Type: application/json
```

**Request Body (JSON):**
```json
{
  "username": "your_username",
  "password": "your_password"
}
```

**Required Fields:**
- `username` (String) - Required
- `password` (String) - Required

**Response:**
- **Status Code:** `200 OK`
- **Content-Type:** `application/json`
- **Response Body:**
  ```json
  {
    "userId": 1,
    "jwt": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ0ZXN0dXNlciIsImlhdCI6MTYz...",
    "username": "your_username"
  }
  ```

---

### **Login Endpoint**

**Path:** `POST /auth/login`

**Full URL:** `http://localhost:8080/auth/login`

**Request Headers:**
```
Content-Type: application/json
```

**Request Body (JSON):**
```json
{
  "username": "your_username",
  "password": "your_password"
}
```

**Required Fields:**
- `username` (String) - Required
- `password` (String) - Required

**Response:**
- **Status Code:** `200 OK`
- **Content-Type:** `application/json`
- **Response Body:**
  ```json
  {
    "userId": 1,
    "jwt": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ0ZXN0dXNlciIsImlhdCI6MTYz...",
    "username": "your_username"
  }
  ```

---

## üìã **3. Request Body Fields**

### **For Signup (`/auth/register`):**
```json
{
  "username": "string",    // Required - Unique username
  "password": "string"     // Required - Plain text password (will be hashed)
}
```

### **For Login (`/auth/login`):**
```json
{
  "username": "string",    // Required - Existing username
  "password": "string"     // Required - Plain text password
}
```

**Notes:**
- Both endpoints use the **same fields**: `username` and `password`
- Passwords are sent as plain text but are automatically hashed (signup) or verified (login) by the backend
- No email field is required (only username)

---

## üéüÔ∏è **4. Authentication Token Return Format**

### **Location:** Response Body (JSON)

The JWT token is returned **in the response body** as part of a JSON object, not in headers.

**Response Structure:**
```json
{
  "userId": 1,
  "jwt": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "username": "your_username"
}
```

**Token Field:** The JWT token is in the `jwt` field of the response.

**How to Use the Token:**
After receiving the token, you must include it in the **Authorization header** for all protected API requests:

```
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

**Important:**
- The word `Bearer` is required (with a space after it)
- The token is a long string (JWT format)
- Tokens expire after **5 hours**

---

## üë§ **5. User Information Returned After Authentication**

After successful authentication (both signup and login), the backend returns:

```json
{
  "userId": 1,                    // Integer - Unique user ID from database
  "jwt": "eyJhbGciOiJIUzI1NiIs...",  // String - JWT authentication token
  "username": "your_username"     // String - The username that was used
}
```

**Fields Explained:**

1. **`userId`** (Integer)
   - The unique ID of the user in the database
   - Auto-generated by the database
   - Useful for tracking which user is logged in

2. **`jwt`** (String)
   - The JWT authentication token
   - Must be included in subsequent API requests
   - Format: `Bearer {token}` in Authorization header
   - Expires after 5 hours

3. **`username`** (String)
   - The username that was registered/logged in
   - Same as the username sent in the request

**Example Response:**
```json
{
  "userId": 5,
  "jwt": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJqb2huIiwiZXhwIjoxNjM4MjE5MjAwLCJpYXQiOjE2MzgyMTU2MDB9.signature",
  "username": "john"
}
```

---

## üìù **Complete Example Requests**

### **Example 1: Signup (cURL)**
```bash
curl -X POST http://localhost:8080/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "username": "john_doe",
    "password": "securePassword123"
  }'
```

**Response:**
```json
{
  "userId": 1,
  "jwt": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "username": "john_doe"
}
```

---

### **Example 2: Login (cURL)**
```bash
curl -X POST http://localhost:8080/auth/login \
  -H "Content-Type: application/json" \
  -d '{
    "username": "john_doe",
    "password": "securePassword123"
  }'
```

**Response:**
```json
{
  "userId": 1,
  "jwt": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "username": "john_doe"
}
```

---

### **Example 3: Using Token in Protected Endpoint**
```bash
curl -X GET http://localhost:8080/api/patients \
  -H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
```

---

## ‚ö†Ô∏è **Error Responses**

### **Username Already Exists (Signup)**
- **Status:** `500 Internal Server Error`
- **Error:** "Username already exists"

### **Invalid Credentials (Login)**
- **Status:** `401 Unauthorized`
- **Error:** Spring Security authentication error

### **User Not Found (Login)**
- **Status:** `401 Unauthorized`
- **Error:** Bad credentials

---

## üîë **Summary**

| Question | Answer |
|----------|--------|
| **Base URL** | `http://localhost:8080` |
| **Signup Endpoint** | `POST /auth/register` |
| **Login Endpoint** | `POST /auth/login` |
| **Request Fields** | `username` (string), `password` (string) |
| **Token Location** | Response body, in `jwt` field |
| **Token Format** | JWT string (starts with `eyJ...`) |
| **User Info Returned** | `userId`, `jwt`, `username` |
| **Token Usage** | `Authorization: Bearer {token}` header |

---

## üìö **Quick Reference**

**Signup:**
- URL: `POST http://localhost:8080/auth/register`
- Body: `{"username": "user", "password": "pass"}`
- Returns: `{"userId": 1, "jwt": "...", "username": "user"}`

**Login:**
- URL: `POST http://localhost:8080/auth/login`
- Body: `{"username": "user", "password": "pass"}`
- Returns: `{"userId": 1, "jwt": "...", "username": "user"}`

**Use Token:**
- Header: `Authorization: Bearer {jwt_token_from_response}`

